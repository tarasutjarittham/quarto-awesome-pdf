% load packages
\usepackage{geometry}
\usepackage{xcolor}
\usepackage{eso-pic}
\usepackage{fancyhdr}
\usepackage{sectsty}
\usepackage{fontspec}
\usepackage{titlesec}

%% Set page size with a wider right margin
\geometry{a4paper, total={170mm,257mm}, left=20mm, top=15mm, bottom=20mm, right=20mm}

%% Define theme colors
\definecolor{light}{HTML}{EFF6FB} % for code snippet
\definecolor{theme}{HTML}{0052CC}
\definecolor{contrast}{HTML}{FFFFFF}
\definecolor{highlight}{HTML}{8FCE00}
\definecolor{dark}{HTML}{172B4D}

%% Add the border at the bottom of the page
\AddToShipoutPicture{% 
    \AtPageLowerLeft{% 
        \put(0,\LenToUnit{0cm}){% 
            \color{theme}\rule{\LenToUnit\paperwidth}{1.5cm}%
        }%
    }%
}


%% Style the page number
\fancypagestyle{mystyle}{
  \fancyhf{}
  \renewcommand\headrulewidth{0pt}
  \fancyfoot[R]{
      \selectfont
      \textcolor{contrast}{\thepage}
    } % Change the font of the page number
  %%\fancyfootoffset{3.8cm}
}
\setlength{\footskip}{35pt}

%% style the chapter/section fonts
\chapterfont{\color{dark}\fontsize{20}{16.8}\selectfont}
\subsectionfont{\color{dark}\fontsize{14}{16.8}\selectfont}
\subsubsectionfont{\color{dark}\fontsize{11}{16.8}\selectfont}
\sectionfont{\color{dark}\fontsize{20}{16.8}}
\titleformat{\section}
  {\sffamily\Large\bfseries\color{dark}\fontsize{20}{16.8}}{\thesection}{1em}{}[{\titlerule[0.8pt]}]



% left align title
\makeatletter
\renewcommand{\maketitle}{\bgroup\setlength{\parindent}{0pt}
\begin{flushleft}
  \textcolor{theme}{
  {\sffamily\huge\textbf{\MakeUppercase{\@title}}} \vspace{0.3cm} \newline
  {\Large {\@subtitle}} \newline
  }
  \@author
\end{flushleft}\egroup
}
\makeatother
